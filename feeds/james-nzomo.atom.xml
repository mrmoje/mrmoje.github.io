<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>TDT</title><link href="/" rel="alternate"></link><link href="/feeds/james-nzomo.atom.xml" rel="self"></link><id>/</id><updated>2015-12-14T03:25:00+03:00</updated><entry><title>Setting up a repo cache with NGINX.</title><link href="/repo_cache_ft_nginx.html" rel="alternate"></link><updated>2015-12-14T03:25:00+03:00</updated><author><name>James Nzomo</name></author><id>tag:,2015-12-14:repo_cache_ft_nginx.html</id><summary type="html">&lt;h1 id="intro"&gt;Intro&lt;/h1&gt;
&lt;p&gt;Say you have a ton of Linux hosts package managed by apt or rpm. Maybe it's
a cluster, cloud env or just a simple learner's lab where a large groups of
(if not all) nodes will end up with the same or similar set of packages
installed and/or upgraded.&lt;/p&gt;
&lt;p&gt;Local Linux repo mirrors would be a fantastic time &amp;amp; bandwidth saver for such
a setup...but the thought of dedicating double, triple or quadruple digit Gigs
(my &lt;a href="pages/glossary#wag"&gt;WAG&lt;/a&gt; as at Dec 2015 - depending on desired distros &amp;amp; architectures)
and the high probability that swathes of space will go wasted on packages
no one will ever install should be enough to make you seek a more optimal
option.&lt;/p&gt;
&lt;p&gt;What you probably want is a good repository caching proxy that initially fetches
a pkg when a host has first dibs request, then stores and serves the same pkg
for subsequent matching requests.&lt;/p&gt;
&lt;h1 id="the-setup"&gt;The Setup&lt;/h1&gt;
&lt;p&gt;There's infinite ways to go about this. This post will cover how it's done using
webserver reverse proxy caching feature to handle requests on behalf of a few
upstream/origin repo servers.&lt;/p&gt;
&lt;p&gt;For more info on the general idea/concept, see:-
&lt;a href="(https://trafficserver.readthedocs.org/en/5.3.x/admin/reverse-proxy-http-redirects.en.html)"&gt;trafficserver&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Though it's possible with
&lt;a href="https://httpd.apache.org/docs/2.4/caching.html"&gt;Apache2&lt;/a&gt;,
&lt;a href="http://redmine.lighttpd.net/projects/1/wiki/Docs_ModCache"&gt;lighthttpd&lt;/a&gt; or even
&lt;a href="http://trafficserver.apache.org"&gt;trafficserver&lt;/a&gt; we'll just go with
&lt;a href="https://www.nginx.com/blog/nginx-caching-guide/"&gt;NGINX&lt;/a&gt; for no apparent reason.&lt;/p&gt;
&lt;p&gt;So start by grabbing yourself some webserver:- &lt;code&gt;apt-get install nginx&lt;/code&gt; and we'll sort this
out in one simple sites-available config.&lt;/p&gt;
&lt;h3 id="the-nginx-config"&gt;The NGINX config&lt;/h3&gt;
&lt;p&gt;The following minimal config sets nginx to handle this biz for the ubuntu
repos defined there in. Read on...this section continues inside the conf file as comments.&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;The&lt;/span&gt; &lt;span class="nt"&gt;upstream&lt;/span&gt; &lt;span class="nt"&gt;directive&lt;/span&gt; &lt;span class="nt"&gt;defining&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;backend&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;upstream&lt;/span&gt; &lt;span class="nt"&gt;repo&lt;/span&gt; &lt;span class="nt"&gt;hosts&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;see&lt;/span&gt; &lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;nginx&lt;/span&gt;&lt;span class="nc"&gt;.org&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;en&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;docs&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;ngx_http_upstream_module&lt;/span&gt;&lt;span class="nc"&gt;.html&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;There&lt;/span&gt; &lt;span class="nt"&gt;is&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="nt"&gt;primary&lt;/span&gt; &lt;span class="nt"&gt;and&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="nt"&gt;backup&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;You&lt;/span&gt; &lt;span class="nt"&gt;can&lt;/span&gt; &lt;span class="nt"&gt;have&lt;/span&gt; &lt;span class="nt"&gt;more&lt;/span&gt; &lt;span class="nt"&gt;than&lt;/span&gt; &lt;span class="nt"&gt;that&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;NGINX&lt;/span&gt; &lt;span class="nt"&gt;will&lt;/span&gt; &lt;span class="nt"&gt;try&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;load&lt;/span&gt; &lt;span class="nt"&gt;balance&lt;/span&gt; &lt;span class="nt"&gt;between&lt;/span&gt; &lt;span class="nt"&gt;them&lt;/span&gt; &lt;span class="nt"&gt;using&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;weighted round-robin&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;algorithm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;Most&lt;/span&gt; &lt;span class="nt"&gt;requests&lt;/span&gt; &lt;span class="nt"&gt;go&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;primary&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;fewer&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;rest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;Error&lt;/span&gt; &lt;span class="nt"&gt;retries&lt;/span&gt; &lt;span class="nt"&gt;trickle&lt;/span&gt; &lt;span class="nt"&gt;down&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="nt"&gt;definitions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;If&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;last&lt;/span&gt; &lt;span class="nt"&gt;errs&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;result&lt;/span&gt; &lt;span class="nt"&gt;is&lt;/span&gt; &lt;span class="nt"&gt;passed&lt;/span&gt; &lt;span class="nt"&gt;on&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;By&lt;/span&gt; &lt;span class="nt"&gt;default&lt;/span&gt; &lt;span class="nt"&gt;I&lt;/span&gt; &lt;span class="nt"&gt;found&lt;/span&gt; &lt;span class="nt"&gt;that&lt;/span&gt; &lt;span class="nt"&gt;if&lt;/span&gt; &lt;span class="nt"&gt;one&lt;/span&gt; &lt;span class="nt"&gt;is&lt;/span&gt; &lt;span class="nt"&gt;unreachable&lt;/span&gt; &lt;span class="nt"&gt;during&lt;/span&gt; &lt;span class="nt"&gt;startup&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;nginx&lt;/span&gt; &lt;span class="nt"&gt;will&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;kaput&lt;/span&gt; &lt;span class="nt"&gt;leaving&lt;/span&gt; &lt;span class="nt"&gt;clues&lt;/span&gt; &lt;span class="nt"&gt;in&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;error&lt;/span&gt; &lt;span class="nt"&gt;log&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="nt"&gt;upstream&lt;/span&gt; &lt;span class="nt"&gt;ubuntu&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;server&lt;/span&gt; &lt;span class="n"&gt;ke&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;archive&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ubuntu&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;server&lt;/span&gt; &lt;span class="n"&gt;archive&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ubuntu&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt; &lt;span class="n"&gt;backup&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;The&lt;/span&gt; &lt;span class="nt"&gt;following&lt;/span&gt; &lt;span class="nt"&gt;directive&lt;/span&gt; &lt;span class="nt"&gt;configures&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;cache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;Storage&lt;/span&gt; &lt;span class="nt"&gt;et&lt;/span&gt; &lt;span class="nt"&gt;all&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;You&lt;/span&gt; &lt;span class="nt"&gt;may&lt;/span&gt; &lt;span class="nt"&gt;want&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;storage&lt;/span&gt; &lt;span class="nt"&gt;location&lt;/span&gt;  &lt;span class="nt"&gt;at&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="nt"&gt;mount&lt;/span&gt; &lt;span class="nt"&gt;point&lt;/span&gt; &lt;span class="nt"&gt;with&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="nt"&gt;filesystem&lt;/span&gt; &lt;span class="nt"&gt;on&lt;/span&gt; &lt;span class="nt"&gt;separate&lt;/span&gt; &lt;span class="nt"&gt;storage&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;device&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;backend&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;match&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;see&lt;/span&gt; &lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;nginx&lt;/span&gt;&lt;span class="nc"&gt;.org&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;en&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;docs&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;ngx_http_proxy_module&lt;/span&gt;&lt;span class="nc"&gt;.html&lt;/span&gt;&lt;span class="nf"&gt;#proxy_cache_path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="nt"&gt;proxy_cache_path&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;repo_mirror&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;defines&lt;/span&gt; &lt;span class="nt"&gt;where&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;cache&lt;/span&gt; &lt;span class="nt"&gt;is&lt;/span&gt; &lt;span class="nt"&gt;stashed&lt;/span&gt;

        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;defines&lt;/span&gt; &lt;span class="nt"&gt;cache&lt;/span&gt; &lt;span class="nt"&gt;path&lt;/span&gt; &lt;span class="nt"&gt;heirarchy&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;yaani&lt;/span&gt; &lt;span class="nt"&gt;num&lt;/span&gt; &lt;span class="nt"&gt;directory&lt;/span&gt; &lt;span class="nt"&gt;levels&lt;/span&gt; &lt;span class="nt"&gt;in&lt;/span&gt; &lt;span class="nt"&gt;cache&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
        &lt;span class="nt"&gt;levels&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;1&lt;/span&gt;&lt;span class="nd"&gt;:2&lt;/span&gt;

        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;defines&lt;/span&gt; &lt;span class="nt"&gt;name&lt;/span&gt; &lt;span class="nt"&gt;and&lt;/span&gt; &lt;span class="nt"&gt;size&lt;/span&gt; &lt;span class="nt"&gt;of&lt;/span&gt; &lt;span class="nt"&gt;zone&lt;/span&gt; &lt;span class="nt"&gt;where&lt;/span&gt; &lt;span class="nt"&gt;all&lt;/span&gt; &lt;span class="nt"&gt;cache&lt;/span&gt; &lt;span class="nt"&gt;keys&lt;/span&gt; &lt;span class="nt"&gt;and&lt;/span&gt; &lt;span class="nt"&gt;cache&lt;/span&gt; &lt;span class="nt"&gt;metadata&lt;/span&gt; &lt;span class="nt"&gt;are&lt;/span&gt; &lt;span class="nt"&gt;stashed&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;Servers&lt;/span&gt; &lt;span class="nt"&gt;as&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="nt"&gt;lookup&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;cached&lt;/span&gt; &lt;span class="nt"&gt;data&lt;/span&gt;
        &lt;span class="nt"&gt;keys_zone&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;repository_cache&lt;/span&gt;&lt;span class="nd"&gt;:50m&lt;/span&gt;

        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;The&lt;/span&gt; &lt;span class="nt"&gt;cached&lt;/span&gt; &lt;span class="nt"&gt;data&lt;/span&gt; &lt;span class="nt"&gt;access&lt;/span&gt; &lt;span class="nt"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nt"&gt;Pkgs&lt;/span&gt; &lt;span class="nt"&gt;get&lt;/span&gt; &lt;span class="nt"&gt;nuked&lt;/span&gt; &lt;span class="nt"&gt;if&lt;/span&gt; &lt;span class="nt"&gt;no&lt;/span&gt; &lt;span class="nt"&gt;access&lt;/span&gt; &lt;span class="nt"&gt;in&lt;/span&gt; &lt;span class="nt"&gt;14&lt;/span&gt; &lt;span class="nt"&gt;days&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
        &lt;span class="nt"&gt;inactive&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;14d&lt;/span&gt;

        &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;Cache&lt;/span&gt; &lt;span class="nt"&gt;size&lt;/span&gt; &lt;span class="nt"&gt;limit&lt;/span&gt;
        &lt;span class="nt"&gt;max_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;100g&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;Our&lt;/span&gt; &lt;span class="nt"&gt;no-name&lt;/span&gt; &lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="nt"&gt;block&lt;/span&gt;
&lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

  &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;Keep&lt;/span&gt; &lt;span class="n"&gt;our&lt;/span&gt; &lt;span class="n"&gt;eyes&lt;/span&gt; &lt;span class="n"&gt;peeled&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="m"&gt;80&lt;/span&gt;
  &lt;span class="n"&gt;listen&lt;/span&gt; &lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;Location&lt;/span&gt; &lt;span class="n"&gt;directive&lt;/span&gt; &lt;span class="n"&gt;for&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ubuntu&lt;/span&gt; &lt;span class="n"&gt;path&lt;/span&gt;
  &lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ubuntu&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;our&lt;/span&gt; &lt;span class="n"&gt;cache&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt;
    &lt;span class="n"&gt;root&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;repo_mirror&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;index_data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;look&lt;/span&gt; &lt;span class="n"&gt;for&lt;/span&gt; &lt;span class="n"&gt;packages&lt;/span&gt; &lt;span class="n"&gt;in&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;following&lt;/span&gt; &lt;span class="n"&gt;order&lt;/span&gt;
    &lt;span class="n"&gt;try_files&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="o"&gt;@&lt;/span&gt;&lt;span class="n"&gt;ubuntu&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;Location&lt;/span&gt; &lt;span class="nt"&gt;directive&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;named&lt;/span&gt; &lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="nt"&gt;defined&lt;/span&gt; &lt;span class="nt"&gt;above&lt;/span&gt;
  &lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="k"&gt;@ubuntu&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;map&lt;/span&gt; &lt;span class="nt"&gt;this&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;upstream&lt;/span&gt; &lt;span class="nt"&gt;definition&lt;/span&gt; &lt;span class="nt"&gt;above&lt;/span&gt;
    &lt;span class="nt"&gt;proxy_pass&lt;/span&gt; &lt;span class="nt"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;ubuntu&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;14days&lt;/span&gt; &lt;span class="nt"&gt;of&lt;/span&gt; &lt;span class="nt"&gt;caching&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;http&lt;/span&gt; &lt;span class="nt"&gt;code&lt;/span&gt; &lt;span class="nt"&gt;200&lt;/span&gt; &lt;span class="nt"&gt;response&lt;/span&gt; &lt;span class="nt"&gt;content&lt;/span&gt;
    &lt;span class="nt"&gt;proxy_cache_valid&lt;/span&gt; &lt;span class="nt"&gt;200&lt;/span&gt; &lt;span class="nt"&gt;14d&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;we&lt;/span&gt; &lt;span class="nt"&gt;set&lt;/span&gt; &lt;span class="nt"&gt;our&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;repository_cache&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;zone&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;caching&lt;/span&gt;
    &lt;span class="nt"&gt;proxy_cache&lt;/span&gt; &lt;span class="nt"&gt;repository_cache&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;Use&lt;/span&gt; &lt;span class="nt"&gt;stale&lt;/span&gt; &lt;span class="nt"&gt;cached&lt;/span&gt; &lt;span class="nt"&gt;data&lt;/span&gt; &lt;span class="nt"&gt;in&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;error&lt;/span&gt; &lt;span class="nt"&gt;events&lt;/span&gt; &lt;span class="nt"&gt;defined&lt;/span&gt;
    &lt;span class="nt"&gt;proxy_cache_use_stale&lt;/span&gt; &lt;span class="nt"&gt;error&lt;/span&gt; &lt;span class="nt"&gt;timeout&lt;/span&gt; &lt;span class="nt"&gt;invalid_header&lt;/span&gt; &lt;span class="nt"&gt;updating&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;pass&lt;/span&gt; &lt;span class="nt"&gt;request&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;next&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;backup&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="nt"&gt;in&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;error&lt;/span&gt; &lt;span class="nt"&gt;events&lt;/span&gt; &lt;span class="nt"&gt;defined&lt;/span&gt;
    &lt;span class="nt"&gt;proxy_next_upstream&lt;/span&gt; &lt;span class="nt"&gt;error&lt;/span&gt; &lt;span class="nt"&gt;timeout&lt;/span&gt; &lt;span class="nt"&gt;invalid_header&lt;/span&gt; &lt;span class="nt"&gt;http_500&lt;/span&gt; &lt;span class="nt"&gt;http_502&lt;/span&gt; &lt;span class="nt"&gt;http_503&lt;/span&gt; &lt;span class="nt"&gt;http_504&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;The above config is by no means comprehensive but it works good enough as a demo. Feel free
to copy paste it into &lt;code&gt;/etc/nginx/sites-available/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;One enhancement that can be made to all this is to configure a reliable storage device for
cache store.&lt;/p&gt;
&lt;h3 id="the-client-side"&gt;The client side&lt;/h3&gt;
&lt;p&gt;It goes without saying that repo related requests have to somehow be routed to the
proxy in order for all this to work.&lt;/p&gt;
&lt;p&gt;One way is to modify the client's &lt;code&gt;/etc/apt/sources.list&lt;/code&gt; or &lt;code&gt;/etc/yum.repos.d/CentOS-*.repo&lt;/code&gt;
to point to our server.&lt;/p&gt;
&lt;p&gt;Another would be to try intercept requests using various forms of MITM sorcery
like forging faux DNS replies for repo FQDNs or router configs/rules.&lt;/p&gt;
&lt;p&gt;Since the client hosts can be configured in most cases and the latter
option is in grey area territory, we'll go with the former and modify the
repo configs. Read on to the next section for that (because the writer wrote
that before the one you reading now and he cannot be bothered to repeat
himself or make mods to the article at this point).&lt;/p&gt;
&lt;h1 id="bonus-vagrant-ansible-deploy-material"&gt;Bonus vagrant-ansible deploy material&lt;/h1&gt;
&lt;p&gt;Just in case you'd like to test all this, or would like some CM to deploy the same
IRL, there is a rudimentary
&lt;a href="https://github.com/mrmoje/repo_cache_plays_staring_nginx"&gt;"demo setup git repo"&lt;/a&gt;
complete with ansible plays and a four host vagrant playground - one "repo-cacher"
and three clients - ubuntu trusty, debian jessie and CentOS 7 - which upon successful
&lt;code&gt;vagrant up&lt;/code&gt;, will be provisioned to fetch their stuff from the repo-cacher.&lt;/p&gt;
&lt;p&gt;To try it out! In case you haven't already, feel free to install latest:-
&lt;a href="https://www.vagrantup.com/downloads"&gt;Vagrant&lt;/a&gt;,
&lt;a href="https://docs.ansible.com/ansible/intro_installation.html"&gt;Ansible&lt;/a&gt; and
&lt;a href="https://www.virtualbox.org/wiki/Downloads"&gt;virtualbox&lt;/a&gt;.
The whole #! will take a while to install, especially if running &lt;code&gt;vagrant up XXXXX&lt;/code&gt;
for the first time and from a poor connection, but IMHO similar IRL bare metal
setup would probably take much longer to depoy.&lt;/p&gt;
&lt;p&gt;Details on how the vagrant and ansible stuff comes together will be blawged in a future
post. For now, checkout the (currently empty)
&lt;a href="https://github.com/mrmoje/repo_cache_plays_staring_nginx/blob/master/README.md"&gt;README&lt;/a&gt;
or just run &lt;code&gt;vagrant up repo-cache&lt;/code&gt; to launch the repo cache then &lt;code&gt;vagrant ssh repo-cache&lt;/code&gt;
and open &lt;code&gt;/etc/nginx/sites-available/repo-cache.conf&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Have a look at the tri-distro proxy cache config and feel free to mod as you please.
Reset it all by running &lt;code&gt;vagrant provision repo-cache&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;You should also be able to browse the upstream repos via the proxy from the following links:-&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://repo-cache.local/ubuntu/"&gt;http://repo-cache.local/ubuntu/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://repo-cache.local/debian/"&gt;http://repo-cache.local/debian/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://repo-cache.local/centos/"&gt;http://repo-cache.local/centos/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;NB&lt;/strong&gt;: Replace the hostname with &lt;code&gt;10.64.0.2&lt;/code&gt; if you dont have a mdns client installed.&lt;/p&gt;
&lt;p&gt;You can subsequently launch one, two or all of the other client hosts
&lt;code&gt;vagrant up repo-cache ubuntu #(or debian or centos)&lt;/code&gt;. Feel free to &lt;code&gt;vagrant ssh&lt;/code&gt; into
them, take a look at &lt;code&gt;/etc/apt/sources.list&lt;/code&gt; or &lt;code&gt;/etc/yum.repos.d/CentOS-*.repo&lt;/code&gt; and
give some package installs a run. Don't forget to peek at &lt;code&gt;repo-cache:/var/repo_mirror&lt;/code&gt;
while you do that.&lt;/p&gt;
&lt;p&gt;Look at the &lt;a href="https://github.com/mrmoje/repo_cache_plays_ft_nginx/blob/master/Vagrantfile"&gt;Vagrant&lt;/a&gt;
file to see hodge-podge of provisioning methods and the
&lt;a href="https://www.gnu.org/software/sed/manual/sed.html"&gt;sedding&lt;/a&gt; that swaps the vanilla repos
for our example proxy.&lt;/p&gt;
&lt;h1 id="outro"&gt;Outro&lt;/h1&gt;
&lt;p&gt;We put a &lt;a href="https://github.com/kili/playbooks/blob/master/playbooks/repository_cache.yaml"&gt;variant of this proxy-cache&lt;/a&gt;
method to good use at a cloud compute startup I used to work for and it worked
out well for us and our tenants.&lt;/p&gt;
&lt;p&gt;In the end amongst other benefits, we were (obviously) able to reduce latency and
network traffic (by how much is anyones guess. We didn't care measure).
We also ended up with more space to put to good use. Space that would have otherwise
been taken up by a multi repo mirror.&lt;/p&gt;
&lt;p&gt;The only possible downside I can fathom for this is that it will still
take longer for the first host/request to get sorted which may be bad for
the installing party depending on how pressed for time they are, but then again
with life, every now and then, somebody has to take one for the team. C'est la Vie!&lt;/p&gt;
&lt;h3 id="res-google-juice-"&gt;RES &amp;amp; google juice:-&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="(https://trafficserver.readthedocs.org/en/5.3.x/admin/reverse-proxy-http-redirects.en.html)"&gt;Trafficserver dox on reverse proxy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="(http://nginx.org/en/docs/http/ngx_http_proxy_module.html)"&gt;NGINX proxy module documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;An excelent tut on caching with nginx with video &amp;amp; docker hands-on:- &lt;a href="http://czerasz.com/2015/03/30/nginx-caching-tutorial/"&gt;http://czerasz.com/2015/03/30/nginx-caching-tutorial/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="nginx"></category><category term="proxy"></category><category term="cache"></category><category term="linux packages"></category></entry><entry><title>TEST POST</title><link href="/testing.html" rel="alternate"></link><updated>1969-12-31T23:59:59+03:00</updated><author><name>James Nzomo</name></author><id>tag:,1969-12-31:testing.html</id><summary type="html">&lt;p&gt;&lt;center&gt;
&lt;img alt="PM5544" src="https://upload.wikimedia.org/wikipedia/commons/c/c4/PM5544_with_non-PAL_signals.png" /&gt;&lt;/p&gt;
&lt;h2 id="problem-stfu"&gt;Problem? &amp;rarr; &lt;button onclick=osc.stop()&gt;STFU!&lt;/button&gt;&lt;/h2&gt;
&lt;p&gt;&lt;/center&gt;
&lt;script type="text/javascript"&gt;
var context = new AudioContext();
var osc = context.createOscillator();
var vol = context.createGain();
osc.frequency.value = 1000;
vol.gain.value = 0.1;
osc.connect(vol);
vol.connect(context.destination);
osc.start(0);
// Problem?
//osc.stop();
&lt;/script&gt;&lt;/p&gt;
&lt;hr&gt;

&lt;h1 id="test-content"&gt;TEST CONTENT&lt;/h1&gt;
&lt;p&gt;with placeholder text generated at &lt;a href="http://slipsum.com/"&gt;Samuel L. Ipsum&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="h1"&gt;H1&lt;/h1&gt;
&lt;h2 id="h2"&gt;H2&lt;/h2&gt;
&lt;h3 id="h3"&gt;H3&lt;/h3&gt;
&lt;h4 id="h4"&gt;H4&lt;/h4&gt;
&lt;h5 id="h5"&gt;H5&lt;/h5&gt;
&lt;h6 id="h6"&gt;H6&lt;/h6&gt;
&lt;h1 id="underline-h1"&gt;Underline-H1&lt;/h1&gt;
&lt;h2 id="underline-h2"&gt;Underline-H2&lt;/h2&gt;
&lt;h3 id="formatting"&gt;Formatting&lt;/h3&gt;
&lt;p&gt;Asterisks -&amp;gt; &lt;em&gt;Italic&lt;/em&gt;, &lt;strong&gt;bold&lt;/strong&gt;, &lt;strong&gt;&lt;em&gt;bold italic&lt;/em&gt;&lt;/strong&gt;&lt;br /&gt;
Underscores -&amp;gt; &lt;em&gt;Italic&lt;/em&gt;, &lt;strong&gt;bold&lt;/strong&gt;, &lt;strong&gt;&lt;em&gt;bold italic&lt;/em&gt;&lt;/strong&gt;&lt;br /&gt;
&lt;code&gt;monospace&lt;/code&gt;&lt;br /&gt;
~~~strikethrough text~~~&lt;/p&gt;
&lt;h3 id="paragraph-one"&gt;Paragraph one&lt;/h3&gt;
&lt;p&gt;Now that there is the Tec-9, a crappy spray gun from South Miami. This gun is
advertised as the most popular gun in American crime. Do you believe that shit?
It actually says that in the little book that comes with it: the most popular
gun in American crime. Like they're actually proud of that shit.&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="c1"&gt;//function sets&lt;/span&gt;
&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;set_portAbit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;bt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;sPORTA&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;bt&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;sPORTA&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;=&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;bt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;PORTA&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sPORTA&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h3 id="paragraph-two"&gt;Paragraph two&lt;/h3&gt;
&lt;p&gt;Well, the way they make shows is, they make one show. That show's called a pilot.
Then they show that show to the people who make shows, and on the strength of
that one show they decide if they're going to make more shows. Some pilots get
picked and become television programs. Some don't, become nothing.
She starred in one of the ones that became nothing.&lt;/p&gt;
&lt;h3 id="paragraph-three-block-quotes"&gt;Paragraph three block quotes&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Your bones don't break, mine do. That's clear. Your cells react to bacteria and
viruses differently than mine. You don't get sick, I do. That's also clear. But
for some reason, you and I react the exact same way to water. We swallow it too
fast, we choke. We get some in our lungs, we drown. However unreal it may seem,
we are connected, you and I. We're on the same curve, just on opposite ends.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="longer-code-block"&gt;Longer Code block&lt;/h3&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="cp"&gt;#include &amp;lt;xc.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stdio.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;stdbool.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;string.h&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include &amp;lt;ctype.h&amp;gt;&lt;/span&gt;

&lt;span class="c1"&gt;// #pragma config statements should precede project file includes.&lt;/span&gt;
&lt;span class="c1"&gt;// Use project enums instead of #define for ON and OFF.&lt;/span&gt;

&lt;span class="c1"&gt;// CONFIG&lt;/span&gt;
&lt;span class="cp"&gt;#pragma config FOSC = INTOSCIO  &lt;/span&gt;&lt;span class="c1"&gt;// Oscillator Selection bits (INTOSC oscillator: I/O function on RA6/OSC2/CLKOUT pin, I/O function on RA7/OSC1/CLKIN)&lt;/span&gt;
&lt;span class="cp"&gt;#pragma config WDTE = OFF       &lt;/span&gt;&lt;span class="c1"&gt;// Watchdog Timer Enable bit (WDT disabled)&lt;/span&gt;
&lt;span class="cp"&gt;#pragma config PWRTE = ON       &lt;/span&gt;&lt;span class="c1"&gt;// Power-up Timer Enable bit (PWRT enabled)&lt;/span&gt;
&lt;span class="cp"&gt;#pragma config MCLRE = ON       &lt;/span&gt;&lt;span class="c1"&gt;// RA5/MCLR/VPP Pin Function Select bit (RA5/MCLR/VPP pin function is MCLR)&lt;/span&gt;
&lt;span class="cp"&gt;#pragma config BOREN = ON       &lt;/span&gt;&lt;span class="c1"&gt;// Brown-out Detect Enable bit (BOD enabled)&lt;/span&gt;
&lt;span class="cp"&gt;#pragma config LVP = OFF        &lt;/span&gt;&lt;span class="c1"&gt;// Low-Voltage Programming Enable bit (RB4/PGM pin has digital I/O function, HV on MCLR must be used for programming)&lt;/span&gt;
&lt;span class="cp"&gt;#pragma config CPD = OFF        &lt;/span&gt;&lt;span class="c1"&gt;// Data EE Memory Code Protection bit (Data memory code protection off)&lt;/span&gt;
&lt;span class="cp"&gt;#pragma config CP = OFF         &lt;/span&gt;&lt;span class="c1"&gt;// Flash Program Memory Code Protection bit (Code protection off)&lt;/span&gt;

&lt;span class="cp"&gt;#define DEBUG&lt;/span&gt;

&lt;span class="cp"&gt;#define _XTAL_FREQ   4000000 &lt;/span&gt;&lt;span class="c1"&gt;// needed by some macros&lt;/span&gt;
&lt;span class="cp"&gt;#define FCY _XTAL_FREQ/4&lt;/span&gt;

&lt;span class="c1"&gt;// Comm Setup&lt;/span&gt;
&lt;span class="cp"&gt;#define BAUDRATE 1200&lt;/span&gt;


&lt;span class="cp"&gt;#define BUZZER_PIN RB5&lt;/span&gt;
&lt;span class="cp"&gt;#define TOGGLE_BUZZER_PIN BUZZER_PIN = ~BUZZER_PIN;&lt;/span&gt;

&lt;span class="c1"&gt;//Globals&lt;/span&gt;
&lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; 
    &lt;span class="n"&gt;receive_buffer&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="c1"&gt;//cmd reveive buffer&lt;/span&gt;
    &lt;span class="n"&gt;sPORTA&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;//PORTA Shadow register&lt;/span&gt;


&lt;span class="c1"&gt;//Prototypes&lt;/span&gt;
&lt;span class="kt"&gt;void&lt;/span&gt;
    &lt;span class="nf"&gt;BOARD_init&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;USART_putc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;buzz_ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;buzz_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;set_portAbit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="n"&gt;bt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;bool&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="n"&gt;interrupt&lt;/span&gt; &lt;span class="nf"&gt;ISR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="kt"&gt;unsigned&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt; &lt;span class="nf"&gt;USART_getc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="c1"&gt;// Main function&lt;/span&gt;
&lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;BOARD_init&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;INIT!&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;buzz_ok&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;hr /&gt;
&lt;p&gt;List of Links:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://tdt.rocks"&gt;TDT&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://kili.io"&gt;KILI&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://nairobilug.or.ke"&gt;NLUG&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;p&gt;Numbered list of links:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="http://www.meetup.com/OpenStack-Nairobi/"&gt;Openstack Nairobi&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.meetup.com/Python-Nairobi/"&gt;Python Nairobi&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr /&gt;
&lt;p&gt;Nested list:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Openstack Nairobi&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;http://www.meetup.com/OpenStack-Nairobi&lt;/li&gt;
&lt;li&gt;https://wiki.openstack.org/wiki/Main_Page&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Python Nairobi&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;http://www.meetup.com/Python-Nairobi&lt;/li&gt;
&lt;li&gt;https://github.com/Python-Nairobi&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;</summary><category term="testing"></category></entry></feed>